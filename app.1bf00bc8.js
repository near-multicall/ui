!function(){function t(t,e,a,n){Object.defineProperty(t,e,{get:a,set:n,enumerable:!0,configurable:!0})}var e=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequired5b2;e.register("1xLrT",(function(a,n){var l;l=a.exports,Object.defineProperty(l,"__esModule",{value:!0,configurable:!0}),t(a.exports,"default",(function(){return u}));var u=e("hQdrk").AppPage})),e.register("hQdrk",(function(a,n){t(a.exports,"AppPage",(function(){return S}));var l=e("4jyMX"),u=e("1ad3U"),r=e("daMGm"),o=e("lJitl"),d=e("6dJjI"),s=e("jzfTN"),c=e("hy8Go"),i=e("5kSJQ"),f=e("lBpE3"),m=e("44iF5"),y=e("6cds3"),v=e("hDmOL"),h=e("kYkTt"),p=e("2jbdu"),k=e("1MoUG"),I=e("dc0x8"),O=e("hAy3h"),S=function(t){"use strict";(0,d.default)(a,t);var e=(0,i.default)(a);function a(t){var n;return(0,u.default)(this,a),n=e.call(this,t),(0,o.default)((0,l.default)(n),"taskID",0),(0,o.default)((0,l.default)(n),"columnID",1),(0,o.default)((0,l.default)(n),"expanded",!1),(0,o.default)((0,l.default)(n),"getTaskID",(function(){return n.taskID})),(0,o.default)((0,l.default)(n),"getColumnID",(function(){return n.columnID})),(0,o.default)((0,l.default)(n),"getTasks",(function(){return I.STORAGE.layout.tasks})),(0,o.default)((0,l.default)(n),"getColumns",(function(){return I.STORAGE.layout.columns})),(0,o.default)((0,l.default)(n),"deleteTask",(function(t){var e=I.STORAGE.layout,n=a.findTaskCoordinates(t),l=n.columnId,u=n.taskIndex;if(null!=l&&null!=u){var r=e.columns[l],d=Array.from(r.taskIds);d.splice(u,1);var i=(0,c.default)((0,s.default)({},r),{taskIds:d}),f=(0,c.default)((0,s.default)({},e),{columns:(0,c.default)((0,s.default)({},e.columns),(0,o.default)({},l,i))});I.STORAGE.setLayout(f)}else console.error("Task not found")})),(0,o.default)((0,l.default)(n),"duplicateTask",(function(t){var e=I.STORAGE.layout,l=a.findTaskCoordinates(t),u=l.columnId,r=l.taskIndex;if(null!=u&&null!=r){var d=JSON.parse(JSON.stringify(e.tasks[t.toString()]));d.id="task-".concat(n.taskID);var i=e.columns[u],f=Array.from(i.taskIds);f.splice(r,0,d.id),n.taskID++;var m=(0,c.default)((0,s.default)({},i),{taskIds:f}),y=(0,c.default)((0,s.default)({},e),{columns:(0,c.default)((0,s.default)({},e.columns),(0,o.default)({},u,m)),tasks:(0,c.default)((0,s.default)({},e.tasks),(0,o.default)({},d.id,d))});window.COPY={from:t,to:d.id},I.STORAGE.setLayout(y)}else console.error("Task not found")})),(0,o.default)((0,l.default)(n),"clear",(function(){var t;console.warn("layout cleared"),window.TASKS&&(window.TASKS=[]),n.taskID=0,n.columnID=1,null===(t=window.EDITOR)||void 0===t||t.edit(null),I.STORAGE.setLayout(k.initialData)})),(0,o.default)((0,l.default)(n),"deleteColumn",(function(t){var e=I.STORAGE.layout,a=Array.from(e.columnOrder);a.splice(t,1);var l=(0,c.default)((0,s.default)({},e),{columnOrder:a});0===a.length&&(l=(0,c.default)((0,s.default)({},e),{columns:(0,c.default)((0,s.default)({},e.columns),(0,o.default)({},"column-".concat(n.columnID),{id:"column-".concat(n.columnID),title:"Drag here",taskIds:[]})),columnOrder:["column-".concat(n.columnID++)]})),I.STORAGE.setLayout(l)})),(0,o.default)((0,l.default)(n),"addColumn",(function(){var t={id:"column-".concat(n.columnID),title:"Drag here",taskIds:[]},e=I.STORAGE.layout,a=Array.from(e.columnOrder);a.push("column-".concat(n.columnID));var l=(0,c.default)((0,s.default)({},e),{columns:(0,c.default)((0,s.default)({},e.columns),(0,o.default)({},"column-".concat(n.columnID),t)),columnOrder:a});n.columnID++,I.STORAGE.setLayout(l)})),(0,o.default)((0,l.default)(n),"onDragEnd",(function(t){var e=I.STORAGE.layout,a=t.destination,l=t.source,u=t.draggableId,r=t.type;if(a&&(a.droppableId!==l.droppableId||a.index!==l.index))if("column"!==r){var d=e.columns[l.droppableId],i=e.columns[a.droppableId];if(d&&i)if(d===i){var f=Array.from(d.taskIds);f.splice(l.index,1),f.splice(a.index,0,u);var m=(0,c.default)((0,s.default)({},d),{taskIds:f}),y=(0,c.default)((0,s.default)({},e),{columns:(0,c.default)((0,s.default)({},e.columns),(0,o.default)({},m.id,m))});I.STORAGE.setLayout(y)}else{var v;if("menu"===i.id)return;if("menu"===d.id){var h=Array.from(d.taskIds),p=h[l.index];h[l.index]="task-".concat(n.taskID);var k=JSON.parse(JSON.stringify(e.tasks[p.toString()]));k.id="task-".concat(n.taskID),I.STORAGE.layout.tasks[k.id]=k,n.taskID++,v=(0,c.default)((0,s.default)({},d),{taskIds:h})}else{var O=Array.from(d.taskIds);O.splice(l.index,1),v=(0,c.default)((0,s.default)({},d),{taskIds:O})}var S=Array.from(i.taskIds);S.splice(a.index,0,u);var g,A=(0,c.default)((0,s.default)({},i),{taskIds:S}),T=(0,c.default)((0,s.default)({},e),{columns:(0,c.default)((0,s.default)({},e.columns),(g={},(0,o.default)(g,v.id,v),(0,o.default)(g,A.id,A),g))});I.STORAGE.setLayout(T)}else console.warn("Something went wrong when dragging from ".concat(d," to ").concat(i))}else{var D=Array.from(e.columnOrder);D.splice(l.index,1),D.splice(a.index,0,u);var x=(0,c.default)((0,s.default)({},e),{columnOrder:D});I.STORAGE.setLayout(x)}})),n.clear(),document.addEventListener("onlayoutupdated",(function(){return n.forceUpdate()})),n}return(0,r.default)(a,[{key:"fromJSON",value:function(t){this.clear();var e=I.STORAGE.layout;if(Array.isArray(t)&&t.length){this.columnID=0;var a=(0,c.default)((0,s.default)({},e),{columnOrder:[],columns:{menu:e.columns.menu}});for(var n in t){var l={id:"column-".concat(this.columnID),title:"Drag here",taskIds:[]},u=Array.from(a.columnOrder);for(var r in u.push("column-".concat(this.columnID)),a=(0,c.default)((0,s.default)({},a),{columns:(0,c.default)((0,s.default)({},a.columns),(0,o.default)({},"column-".concat(this.columnID),l)),columnOrder:u}),this.columnID++,t[n]){var d={id:"task-".concat(this.taskID++),addr:"",func:"",json:t[n][r]};a.columns[l.id].taskIds.push(d.id),a.tasks[d.id]=d}}I.STORAGE.setLayout(a)}}},{key:"fromBase64",value:function(t){this.clear();var e=I.STORAGE.layout;if(Array.isArray(t)&&t.length){this.columnID=0;var a=(0,c.default)((0,s.default)({},e),{columnOrder:[],columns:{menu:e.columns.menu}});for(var n in t){var l={id:"column-".concat(this.columnID),title:"Drag here",taskIds:[]},u=Array.from(a.columnOrder);for(var r in u.push("column-".concat(this.columnID)),a=(0,c.default)((0,s.default)({},a),{columns:(0,c.default)((0,s.default)({},a.columns),(0,o.default)({},"column-".concat(this.columnID),l)),columnOrder:u}),this.columnID++,t[n]){var d=t[n][r],i=d.address,f=d.actions,y={id:"task-".concat(this.taskID++),addr:"",func:"",json:{address:i,actions:f.map((function(t){return{func:t.func,args:JSON.parse(m.Base64.decode(t.args)),gas:t.gas,depo:t.depo}}))}};a.columns[l.id].taskIds.push(y.id),a.tasks[y.id]=y}}I.STORAGE.setLayout(a)}}},{key:"toJSON",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=I.STORAGE.layout,a=[],n=!0,l=!1,u=void 0;try{for(var r,o=e.columnOrder[Symbol.iterator]();!(n=(r=o.next()).done);n=!0){var d=r.value;if(0!==e.columns[d].taskIds.length){a.push([]);var s=!0,c=!1,i=void 0;try{for(var f,m=function(){var e=f.value,n=TASKS.find((function(t){return t.id===e}));if(n)if(t)try{a[a.length-1].push(n.instance.current.toCall())}catch(t){return"continue"}else a[a.length-1].push(n.instance.current.toCall());else console.warn("no task with id ".concat(e))},y=e.columns[d].taskIds[Symbol.iterator]();!(s=(f=y.next()).done);s=!0)m()}catch(t){c=!0,i=t}finally{try{s||null==y.return||y.return()}finally{if(c)throw i}}}}}catch(t){l=!0,u=t}finally{try{n||null==o.return||o.return()}finally{if(l)throw u}}return a}},{key:"toBase64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=I.STORAGE.layout,a=[],n=!0,l=!1,u=void 0;try{for(var r,o=e.columnOrder[Symbol.iterator]();!(n=(r=o.next()).done);n=!0){var d=r.value;if(0!==e.columns[d].taskIds.length){a.push([]);var s=!0,c=!1,i=void 0;try{for(var f,m=function(){var e=f.value,n=TASKS.find((function(t){return t.id===e}));if(n)if(t)try{a[a.length-1].push(O.fromCall.toBase64(n.instance.current.toCall()))}catch(t){return"continue"}else a[a.length-1].push(O.fromCall.toBase64(n.instance.current.toCall()));else console.warn("no task with id ".concat(e))},y=e.columns[d].taskIds[Symbol.iterator]();!(s=(f=y.next()).done);s=!0)m()}catch(t){c=!0,i=t}finally{try{s||null==y.return||y.return()}finally{if(c)throw i}}}}}catch(t){l=!0,u=t}finally{try{n||null==o.return||o.return()}finally{if(l)throw u}}return a}},{key:"toErrors",value:function(){var t=I.STORAGE.layout,e=[];if(!(null===window||void 0===window?void 0:window.TASKS))return e;var a=TASKS.filter((function(e){return!t.columns.menu.taskIds.includes(e.id)})).map((function(t){return t.instance.current})),n=!0,l=!1,u=void 0,r=!0,o=!1,d=void 0;try{for(var s,c=a[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var i=s.value;try{for(var f,m=i.schema.errors()[Symbol.iterator]();!(n=(f=m.next()).done);n=!0){var y=f.value;e.push({task:i,message:y.message})}}catch(t){l=!0,u=t}finally{try{n||null==m.return||m.return()}finally{if(l)throw u}}}}catch(t){o=!0,d=t}finally{try{r||null==c.return||c.return()}finally{if(o)throw d}}return e}},{key:"export",value:function(){return JSON.stringify({schedules:this.toBase64()})}},{key:"empty",value:function(){var t=I.STORAGE.layout;return 1===t.columnOrder.length&&0===t.columns[t.columnOrder[0]].taskIds.length}},{key:"setExpanded",value:function(t){this.expanded=t,this.forceUpdate(),SIDEBAR.forceUpdate()}},{key:"componentDidMount",value:function(){window.SIDEBAR.switchPage("app"),window.LAYOUT=this,I.STORAGE.load()}},{key:"render",value:function(){var t=this,e=I.STORAGE.layout;return(0,f.jsxs)(v.DragDropContext,{onDragEnd:this.onDragEnd,children:[(0,f.jsx)(v.Droppable,{droppableId:"layout",direction:"horizontal",type:"column",children:function(a){return(0,f.jsxs)("div",{className:"layout-wrapper",children:[(0,f.jsxs)("div",(0,c.default)((0,s.default)({className:"layout-container",tutorial:t.empty()?"yes":"no"},a.droppableProps),{ref:a.innerRef,children:[e.columnOrder.map((function(t,a){var n=e.columns[t],l=n.taskIds.map((function(t){return e.tasks[t]}));return(0,f.jsx)(h.Column,{column:n,tasks:l,index:a},n.id)})),a.placeholder]})),(0,f.jsx)("div",{className:"empty-container ".concat(t.expanded?"expanded-empty":"")})]})}}),(0,f.jsx)(p.Menu,{layout:this})]})}}]),a}(y.Component);(0,o.default)(S,"findTaskCoordinates",(function(t){var e,a=I.STORAGE.layout;return{columnId:a.columnOrder.find((function(n){return(e=a.columns[n].taskIds.indexOf(t))>=0})),taskIndex:e}}))}))}();
//# sourceMappingURL=app.1bf00bc8.js.map
